<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" data-translate-meta-description="metaDescriptionContent" content="Download music and video from YouTube, YouTube Music and SoundCloud in MP3, M4A, Opus or MP4 formats.">
    <meta name="theme-color" content="#0f172a">
    <title data-translate-key="pageTitle">YouTube, YouTube Music & SoundCloud Downloader</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/jpeg" href="{{ url_for('static', filename='musicjacker.jpg') }}">
    <style>
body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow-x: hidden;
        }
        body.overflow-hidden {
            overflow: hidden;
        }

        body:lang(ar) {
            font-family: 'Tajawal', sans-serif;
            text-align: right;
        }
        body:lang(ar) .text-left {
            text-align: right;
        }
        body:lang(ar) ul {
            padding-left: 0;
            padding-right: 1.5rem;
        }
        body:lang(ar) .file-download-status {
            margin-left: 0;
            margin-right: 0.5rem;
        }
        body:lang(ar) .close-overlay-button {
            right: auto;
            left: 1.25rem;
        }

        .night-sky-bg-main {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0b1021, #111827, #1e293b);
            background-size: 300% 300%;
            animation: gradientBGMain 30s ease infinite;
            z-index: -2;
            overflow: hidden;
        }
        @keyframes gradientBGMain {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .star-main {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            animation: twinkleMain 3s infinite ease-in-out;
            box-shadow: 0 0 3px rgba(255, 255, 255, 0.5), 0 0 6px rgba(255, 255, 255, 0.3);
        }
        @keyframes twinkleMain {
            0%, 100% { opacity: 0.4; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.1); }
            100% { opacity: 0.4; transform: scale(0.8); }
        }
        .moon-main {
            position: absolute;
            width: 100px;
            height: 100px;
            background-color: #f0f8ff;
            border-radius: 50%;
            box-shadow: 0 0 25px #f0f8ff, 0 0 40px #add8e6, 0 0 60px #87cefa;
            top: 10%;
            left: 15%;
            animation: gentleDriftMain 15s ease-in-out infinite alternate, moonPhase 60s linear infinite;
            opacity: 0;
            animation-fill-mode: forwards;
            animation-name: gentleDriftMain, moonPhase, fadeInMoon;
            animation-duration: 15s, 60s, 2s;
            animation-timing-function: ease-in-out, linear, ease-out;
            animation-iteration-count: infinite, infinite, 1;
            animation-direction: alternate, normal, normal;
            animation-delay: 0s, 0s, 0.5s;
        }
         @keyframes fadeInMoon {
            to { opacity: 0.85; }
        }
        @keyframes gentleDriftMain {
            0% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(20px, 10px) scale(1.05); }
            100% { transform: translate(0, 0) scale(1); }
        }
        @keyframes moonPhase {
            0% { box-shadow: 0 0 25px #f0f8ff, 0 0 40px #add8e6, 0 0 60px #87cefa, inset -10px 0 15px rgba(0,0,0,0.1); }
            50% { box-shadow: 0 0 25px #f0f8ff, 0 0 40px #add8e6, 0 0 60px #87cefa, inset 5px 0 15px rgba(0,0,0,0.05); }
            100% { box-shadow: 0 0 25px #f0f8ff, 0 0 40px #add8e6, 0 0 60px #87cefa, inset -10px 0 15px rgba(0,0,0,0.1); }
        }

        .reactbits-bg-layer {
            position: absolute;
            inset: 0;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.6s ease;
            z-index: -1;
        }
        body.bg-mode-dot-grid .reactbits-bg-layer[data-bg-layer="dot-grid"],
        body.bg-mode-faulty-terminal .reactbits-bg-layer[data-bg-layer="faulty-terminal"],
        body.bg-mode-aurora .reactbits-bg-layer[data-bg-layer="aurora"],
        body.bg-mode-dither .reactbits-bg-layer[data-bg-layer="dither"] {
            opacity: 1;
        }

        .reactbits-dot-grid {
            mix-blend-mode: lighten;
            overflow: hidden;
            background: radial-gradient(circle at top center, rgba(56, 189, 248, 0.2), transparent 55%);
        }
        .reactbits-dot-grid .dot-grid-pattern {
            position: absolute;
            inset: -200px;
            background-image:
                radial-gradient(rgba(148, 163, 184, 0.55) 1px, transparent 1px),
                radial-gradient(rgba(148, 163, 184, 0.25) 1px, transparent 1px);
            background-size: 28px 28px, 28px 28px;
            background-position: 0 0, 14px 14px;
            opacity: 0.7;
            animation: dotGridDrift 22s linear infinite;
        }
        .dot-grid-glow {
            position: absolute;
            inset: -30%;
            background: conic-gradient(from 120deg, rgba(56, 189, 248, 0.25), rgba(14, 165, 233, 0.1), rgba(59, 130, 246, 0.3), rgba(56, 189, 248, 0.15));
            filter: blur(140px);
            animation: dotGridPulse 16s ease-in-out infinite;
        }
        @keyframes dotGridDrift {
            0% { transform: translate3d(0, 0, 0) rotate(0deg); }
            50% { transform: translate3d(40px, -40px, 0) rotate(1deg); }
            100% { transform: translate3d(0, 0, 0) rotate(0deg); }
        }
        @keyframes dotGridPulse {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            40% { opacity: 0.85; transform: scale(1.08); }
        }

        .reactbits-faulty-terminal {
            overflow: hidden;
            background: radial-gradient(circle at 30% 20%, rgba(74, 222, 128, 0.3), transparent 50%),
                        radial-gradient(circle at 80% 0%, rgba(16, 185, 129, 0.35), transparent 45%),
                        #03140d;
        }
        .reactbits-faulty-terminal::before,
        .reactbits-faulty-terminal::after {
            content: "";
            position: absolute;
            width: 70%;
            height: 2px;
            left: 15%;
            background: linear-gradient(90deg, rgba(34, 197, 94, 0), rgba(34, 197, 94, 0.8), rgba(34, 197, 94, 0));
            filter: blur(0.5px);
            opacity: 0.5;
            animation: faultyBlink 5s ease-in-out infinite;
        }
        .reactbits-faulty-terminal::before { top: 25%; }
        .reactbits-faulty-terminal::after { bottom: 20%; animation-delay: 2s; }
        .faulty-terminal-noise {
            position: absolute;
            inset: 0;
            background-image: repeating-linear-gradient(0deg, rgba(16, 94, 80, 0.2) 0px, rgba(16, 94, 80, 0.2) 2px, transparent 2px, transparent 4px);
            opacity: 0.9;
            animation: faultyNoise 0.9s steps(2) infinite;
        }
        .faulty-terminal-scanline {
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, transparent 0%, rgba(34, 197, 94, 0.35) 45%, transparent 80%);
            mix-blend-mode: screen;
            animation: faultyScanline 4s linear infinite;
        }
        .faulty-terminal-glitch {
            position: absolute;
            inset: -20%;
            background: conic-gradient(from 220deg, rgba(34, 197, 94, 0.25), transparent 60%);
            animation: faultyGlitch 5s linear infinite;
        }
        @keyframes faultyNoise {
            0% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
            100% { transform: translateY(0); }
        }
        @keyframes faultyScanline {
            0% { transform: translateY(-100%); opacity: 0; }
            20% { opacity: 0.8; }
            50% { opacity: 0.2; }
            100% { transform: translateY(100%); opacity: 0; }
        }
        @keyframes faultyBlink {
            0%, 100% { opacity: 0.15; }
            50% { opacity: 0.8; }
        }
        @keyframes faultyGlitch {
            0% { transform: translate3d(0,0,0) scale(1); opacity: 0.2; }
            50% { transform: translate3d(-8px, 6px, 0) scale(1.03); opacity: 0.45; }
            100% { transform: translate3d(0,0,0) scale(1); opacity: 0.2; }
        }

        .reactbits-aurora {
            overflow: hidden;
            background: radial-gradient(circle at 50% 5%, rgba(76, 29, 149, 0.4), transparent 60%);
        }
        .aurora-band {
            position: absolute;
            width: 180%;
            height: 50%;
            left: -40%;
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.3), rgba(168, 85, 247, 0.4), rgba(236, 72, 153, 0.3));
            filter: blur(100px);
            opacity: 0.8;
            transform: skewY(-8deg);
            animation: auroraDrift 20s ease-in-out infinite alternate;
        }
        .aurora-band-one { top: 0%; animation-duration: 18s; }
        .aurora-band-two { top: 45%; animation-duration: 26s; animation-delay: 2s; }
        .aurora-stars {
            position: absolute;
            inset: 0;
            background-image: radial-gradient(rgba(255,255,255,0.4) 1px, transparent 1px);
            background-size: 100px 100px;
            animation: auroraStars 35s linear infinite;
            opacity: 0.45;
        }
        @keyframes auroraDrift {
            0% { transform: translate3d(-10%, -5%, 0) skewY(-6deg); }
            50% { transform: translate3d(8%, 6%, 0) skewY(-12deg); }
            100% { transform: translate3d(-5%, 0%, 0) skewY(-9deg); }
        }
        @keyframes auroraStars {
            from { transform: translate3d(0,0,0); }
            to { transform: translate3d(-60px, -40px, 0); }
        }

        .reactbits-dither {
            overflow: hidden;
            background:
                radial-gradient(circle at 85% 15%, rgba(254, 215, 170, 0.25), transparent 50%),
                radial-gradient(circle at 10% 80%, rgba(96, 165, 250, 0.25), transparent 45%),
                #050810;
        }
        .reactbits-dither::before {
            content: "";
            position: absolute;
            inset: 0;
            background-image:
                radial-gradient(circle, rgba(248, 250, 252, 0.12) 1px, transparent 1px),
                radial-gradient(circle, rgba(148, 163, 184, 0.1) 1px, transparent 1px);
            background-size: 4px 4px, 6px 6px;
            mix-blend-mode: lighten;
            opacity: 0.5;
            animation: ditherDrift 40s linear infinite;
        }
        .dither-overlay {
            position: absolute;
            inset: -20%;
            background: conic-gradient(from 0deg, rgba(255, 255, 255, 0.08), rgba(248, 113, 113, 0.25), rgba(59, 130, 246, 0.2), rgba(255, 255, 255, 0.08));
            mix-blend-mode: screen;
            animation: ditherPulse 28s ease-in-out infinite;
        }
        @keyframes ditherDrift {
            from { transform: translate3d(0,0,0); }
            to { transform: translate3d(50px, -50px, 0); }
        }
        @keyframes ditherPulse {
            0% { transform: rotate(0deg) scale(1); opacity: 0.35; }
            50% { transform: rotate(180deg) scale(1.1); opacity: 0.65; }
            100% { transform: rotate(360deg) scale(1); opacity: 0.35; }
        }

        body.bg-mode-faulty-terminal {
            color: #d1fae5;
            background-color: #03150d;
        }
        body.bg-mode-aurora {
            color: #f5e1ff;
        }
        body.bg-mode-faulty-terminal .main-card {
            background-color: rgba(1, 32, 20, 0.9);
            border: 1px solid rgba(34, 197, 94, 0.35);
            box-shadow: 0 20px 50px rgba(1, 32, 20, 0.7);
        }
        body.bg-mode-aurora .main-card {
            background: rgba(30, 27, 75, 0.92);
            border: 1px solid rgba(192, 132, 252, 0.45);
            box-shadow: 0 25px 55px rgba(76, 29, 149, 0.55);
        }
        body.bg-mode-dither .main-card {
            background: rgba(15, 23, 42, 0.92);
            border: 1px solid rgba(252, 211, 77, 0.25);
        }
        body.bg-mode-faulty-terminal .nav-button {
            background-color: rgba(6, 78, 59, 0.75);
            color: #bbf7d0;
            border-color: rgba(34, 197, 94, 0.3);
        }
        body.bg-mode-faulty-terminal .nav-button:hover {
            background-color: rgba(16, 185, 129, 0.9);
            color: #052e16;
        }
        body.bg-mode-aurora .nav-button {
            background-color: rgba(76, 29, 149, 0.8);
            color: #ede9fe;
        }
        body.bg-mode-aurora .nav-button:hover {
            background-color: rgba(168, 85, 247, 0.9);
        }
        body.bg-mode-faulty-terminal .text-slate-400,
        body.bg-mode-faulty-terminal .text-slate-300,
        body.bg-mode-faulty-terminal .text-slate-200,
        body.bg-mode-faulty-terminal label,
        body.bg-mode-faulty-terminal p,
        body.bg-mode-faulty-terminal span {
            color: #bdf9d3 !important;
        }
        body.bg-mode-faulty-terminal .music-icon-animated line {
            stroke: #34d399;
        }
        body.bg-mode-aurora .text-slate-400,
        body.bg-mode-aurora .text-slate-300,
        body.bg-mode-aurora .text-slate-200 {
            color: #f0d1ff !important;
        }
        body.bg-mode-aurora .music-icon-animated line {
            stroke: #d8b4fe;
        }
        body.bg-mode-night .moon-main,
        body.bg-mode-dot-grid .moon-main {
            opacity: 0.85;
            transform: scale(1);
        }
        body.bg-mode-faulty-terminal .moon-main,
        body.bg-mode-aurora .moon-main,
        body.bg-mode-dither .moon-main {
            opacity: 0;
            transform: scale(0.8);
        }
        body.bg-mode-faulty-terminal input,
        body.bg-mode-faulty-terminal select,
        body.bg-mode-faulty-terminal textarea {
            background-color: rgba(6, 78, 59, 0.35);
            border-color: rgba(16, 185, 129, 0.45);
            color: #ccfbf1;
        }
        body.bg-mode-faulty-terminal ::placeholder {
            color: #99f6e4;
        }
        body.bg-mode-aurora input,
        body.bg-mode-aurora select,
        body.bg-mode-aurora textarea {
            background-color: rgba(91, 33, 182, 0.35);
            border-color: rgba(192, 132, 252, 0.45);
            color: #f5e1ff;
        }
        body.bg-mode-aurora ::placeholder {
            color: #e9d5ff;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 1rem;
            z-index: 1;
            padding-bottom: 100px;
            flex-grow: 1;
        }

.top-nav-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            z-index: 50;
            padding: 1.25rem 1.5rem 0.5rem;
            pointer-events: none;
        }
        .fluid-glass-nav {
            position: relative;
            width: 100%;
            max-width: 1100px;
            border-radius: 1.75rem;
            border: 1px solid rgba(148, 163, 184, 0.25);
            background: radial-gradient(circle at 20% 20%, rgba(94, 234, 212, 0.12), transparent 45%),
                        linear-gradient(135deg, rgba(15, 23, 42, 0.92), rgba(15, 23, 42, 0.75));
            box-shadow: 0 20px 60px rgba(2, 6, 23, 0.55);
            overflow: hidden;
            padding: 1.1rem 1.5rem;
            pointer-events: auto;
        }
        .fluid-glass-nav::before,
        .fluid-glass-nav::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background: radial-gradient(circle at 10% 10%, rgba(14, 165, 233, 0.35), transparent 50%);
            opacity: 0.4;
            filter: blur(40px);
            animation: fluidGlow 18s ease-in-out infinite alternate;
            pointer-events: none;
        }
        .fluid-glass-nav::after {
            background: radial-gradient(circle at 80% 0%, rgba(236, 72, 153, 0.25), transparent 55%);
            animation-delay: 6s;
        }
        .fluid-blob {
            position: absolute;
            width: 220px;
            height: 220px;
            border-radius: 45% 55% 60% 40%;
            filter: blur(50px);
            opacity: 0.45;
            mix-blend-mode: screen;
            animation: fluidBlob 16s ease-in-out infinite;
            pointer-events: none;
        }
        .fluid-blob.one {
            background: rgba(56, 189, 248, 0.35);
            top: -60px;
            left: -40px;
        }
        .fluid-blob.two {
            background: rgba(147, 197, 253, 0.35);
            bottom: -70px;
            right: 5%;
            animation-delay: 4s;
        }
        .fluid-blob.three {
            background: rgba(248, 113, 113, 0.25);
            top: 10%;
            right: 35%;
            animation-delay: 8s;
        }
        .fluid-nav-content {
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1.25rem;
            flex-wrap: wrap;
        }
        .top-nav-buttons {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        @media (max-width: 768px) {
            .fluid-nav-content {
                flex-direction: column;
                align-items: stretch;
            }
            .top-nav-buttons {
                justify-content: center;
            }
            .header-controls {
                width: 100%;
            }
        }

        .nav-button {
            padding: 0.65rem 1.35rem;
            background-color: rgba(56, 78, 126, 0.45);
            color: #e2e8f0;
            border: 1px solid rgba(148, 163, 184, 0.25);
            border-radius: 999px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            backdrop-filter: blur(6px);
            box-shadow: inset 0 0 0 rgba(14, 165, 233, 0);
        }
        .nav-button:hover {
            background-color: rgba(56, 189, 248, 0.18);
            border-color: rgba(125, 211, 252, 0.65);
            color: white;
            box-shadow: inset 0 0 20px rgba(14, 165, 233, 0.35);
        }

        @keyframes fluidGlow {
            0% { transform: translate3d(0,0,0) scale(1); opacity: 0.35; }
            100% { transform: translate3d(20px,-20px,0) scale(1.1); opacity: 0.55; }
        }
        @keyframes fluidBlob {
            0% { transform: translate3d(0,0,0) rotate(0deg); }
            50% { transform: translate3d(30px,-25px,0) rotate(12deg); }
            100% { transform: translate3d(-10px,10px,0) rotate(-6deg); }
        }

        .lang-switcher-container,
        .background-switcher-container {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            color: #cbd5e1;
            letter-spacing: 0.08em;
            font-size: 0.7rem;
        }
        .lang-switcher-container label,
        .background-switcher-container label {
            font-weight: 600;
        }
        .lang-switcher-container label {
            text-transform: none;
        }
        .background-switcher-container label {
            text-transform: uppercase;
        }

        .main-card {
            background-color: rgba(30, 41, 59, 0.88);
            backdrop-filter: blur(10px);
            padding: 2rem 2.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.45);
            width: 100%;
            max-width: 580px;
            margin-top: 8rem;
            opacity: 0;
            transform: translateY(20px);
            animation: cardEnterMain 0.7s 0.3s cubic-bezier(0.25,0.8,0.25,1) forwards;
        }
        @keyframes cardEnterMain {
            to { opacity: 1; transform: translateY(0); }
        }

        .overlay-section {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(15, 23, 42, 0.92);
            backdrop-filter: blur(10px);
            z-index: 100;
            display: flex;
            visibility: hidden;
            opacity: 0;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            transition: opacity 0.3s ease-out, visibility 0s linear 0.3s;
        }
        .overlay-section.visible {
            visibility: visible;
            opacity: 1;
            transition: opacity 0.3s ease-out, visibility 0s linear 0s;
        }

        .info-content-card {
            background-color: rgba(45, 55, 72, 0.97);
            padding: 1.5rem 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            max-width: 700px;
            width: calc(100% - 2rem);
            color: #e2e8f0;
            margin: auto;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
            position: relative;
        }

        .info-content-card h2 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #38bdf8;
            margin-bottom: 1.25rem;
            text-align: center;
        }
        .info-content-card h3 {
            font-size: 1.15rem;
            font-weight: 600;
            color: #7dd3fc;
            margin-top: 1.25rem;
            margin-bottom: 0.6rem;
            border-bottom: 1px solid rgb(71 85 105 / 0.5);
            padding-bottom: 0.4rem;
        }
        .info-content-card p, .info-content-card li {
            font-size: 0.95rem;
            line-height: 1.65;
            margin-bottom: 0.6rem;
        }
        .info-content-card ul {
            list-style: disc;
            padding-left: 1.5rem;
        }
        .info-content-card code {
            background-color: rgb(51 65 85 / 0.7);
            padding: 0.1rem 0.4rem;
            border-radius: 0.25rem;
            font-family: monospace;
            color: #f0f0f0;
        }

        .loader { border-top-color: #0ea5e9; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .lang-switcher-container select,
        .background-switcher-container select { padding: 0.6rem 1rem; border-radius: 0.5rem; border: 1px solid rgb(71 85 105 / 0.7); background-color: rgb(30 41 59 / 0.85); backdrop-filter: blur(6px); color: white; font-size: 0.875rem; transition: all 0.2s ease-in-out; min-width: 165px; }
        .lang-switcher-container select:hover,
        .background-switcher-container select:hover { border-color: #0ea5e9; background-color: rgb(51 65 85 / 0.9); }
        @media (max-width: 640px) {
            .header-controls {
                flex-direction: column;
                align-items: stretch;
            }
            .lang-switcher-container select,
            .background-switcher-container select {
                width: 100%;
            }
            .background-switcher-container {
                align-items: flex-start;
            }
        }
        #statusArea ul::-webkit-scrollbar { width: 8px; }
        #statusArea ul::-webkit-scrollbar-track { background: rgb(51 65 85); border-radius: 10px; }
        #statusArea ul::-webkit-scrollbar-thumb { background: rgb(71 85 105); border-radius: 10px; }
        #statusArea ul::-webkit-scrollbar-thumb:hover { background: #0ea5e9; }

        input[type="url"]:focus, select:focus { box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.5); border-color: #0ea5e9 !important; }
        .submit-button { transition: all 0.3s ease-out; }
        .submit-button:hover { transform: translateY(-3px) scale(1.03); box-shadow: 0 12px 25px rgba(14, 165, 233, 0.25), 0 8px 10px rgba(14, 165, 233, 0.22); }
        .submit-button:active { transform: translateY(-1px) scale(0.99); box-shadow: 0 5px 10px rgba(14, 165, 233, 0.2), 0 2px 4px rgba(14, 165, 233, 0.18); }
        .status-message-item { opacity: 0; transform: translateY(10px); animation: fadeInItem 0.5s ease-out forwards; }
        @keyframes fadeInItem { to { opacity: 1; transform: translateY(0); } }
        .music-icon-animated svg line { stroke-dasharray: 50; stroke-dashoffset: 50; animation: drawLine 1.5s ease-out forwards infinite alternate; }
        .music-icon-animated svg line:nth-child(1) { animation-delay: 0s; }
        .music-icon-animated svg line:nth-child(2) { animation-delay: 0.2s; }
        .music-icon-animated svg line:nth-child(3) { animation-delay: 0.4s; }
        .music-icon-animated svg line:nth-child(4) { animation-delay: 0.6s; }
        .music-icon-animated svg line:nth-child(5) { animation-delay: 0.8s; }
        .music-icon-animated svg line:nth-child(6) { animation-delay: 1.0s; }
        @keyframes drawLine { 50% { stroke-dashoffset: 0; } 100% { stroke-dashoffset: 0; transform: scaleY(0.3); } }

        .main-card .text-center, .main-card form > div, .main-card .submit-button {
            opacity: 0;
            transform: translateY(15px);
            animation: formItemEnter 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
        .main-card .text-center { animation-delay: 0.1s; }
        .main-card form > div:nth-child(1) { animation-delay: 0.2s; }
        .main-card form > div:nth-child(2) { animation-delay: 0.3s; }
        .main-card .submit-button { animation-delay: 0.4s; }

        @keyframes formItemEnter {
            to { opacity: 1; transform: translateY(0); }
        }
        .app-footer {
            opacity: 0;
            animation: fadeInFooter 1s 0.5s ease-out forwards;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 0.75rem 1rem;
            background-color: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            z-index: 5;
            width: 100%;
        }
        @keyframes fadeInFooter {
            to { opacity: 1; }
        }
        .file-download-status {
            font-size: 0.75rem;
            color: #94a3b8;
            margin-left: 0.5rem;
        }
        .telegram-link-container { margin-top: 0.75rem; font-size: 0.875rem; color: #94a3b8; }
        .telegram-link-container a { color: #38bdf8; text-decoration: underline; }
        .telegram-link-container a:hover { color: #7dd3fc; }

        .close-overlay-button {
            position: fixed;
            top: 1.25rem;
            right: 1.25rem;
            background: rgba(51, 65, 85, 0.5);
            border: 1px solid rgba(100,116,139,0.5);
            color: #cbd5e1;
            font-size: 1.5rem;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            cursor: pointer;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            z-index: 110;
            backdrop-filter: blur(3px);
        }
    </style>
</head>
<body class="text-white min-h-screen flex flex-col items-center p-4 selection:bg-sky-500 selection:text-white bg-mode-night">
    <div class="night-sky-bg-main">
        <div class="moon-main"></div>
        <div class="reactbits-bg-layer reactbits-dot-grid" data-bg-layer="dot-grid">
            <div class="dot-gripattern"></div>
            <div class="dot-grid-glow"></div>
        </div>
        <div class="reactbits-bg-layer reactbits-faulty-terminal" data-bg-layer="faulty-terminal">
            <div class="faulty-terminal-noise"></div>
            <div class="faulty-terminal-scanline"></div>
            <div class="faulty-terminal-glitch"></div>
        </div>
        <div class="reactbits-bg-layer reactbits-aurora" data-bg-layer="aurora">
            <div class="aurora-band aurora-band-one"></div>
            <div class="aurora-band aurora-band-two"></div>
            <div class="aurora-stars"></div>
        </div>
        <div class="reactbits-bg-layer reactbits-dither" data-bg-layer="dither">
            <div class="dither-overlay"></div>
        </div>
    </div>

    <header class="top-nav-container">
        <div class="fluid-glass-nav">
            <div class="fluid-blob one"></div>
            <div class="fluid-blob two"></div>
            <div class="fluid-blob three"></div>
            <div class="fluid-nav-content">
                <div class="top-nav-buttons">
                    <button id="infoButton" class="nav-button" data-translate-key="navInfoButton">Info</button>
                    <button id="copyrightButton" class="nav-button" data-translate-key="navCopyrightButton">Copyright</button>
                    <button id="updatesButton" class="nav-button" data-translate-key="navUpdatesButton">Updates (Blog)</button>
                    <button id="githubButton" class="nav-button" data-translate-key="navGithubButton">GitHub</button>
                </div>
                <div class="header-controls">
                    <div class="lang-switcher-container">
                        <label for="languageSelector" data-translate-key="languageLabel">Language:</label>
                        <select id="languageSelector" title="Select Language">
                            <option value="en">English</option>
                            <option value="ru">Русский</option>
                            <option value="es">Español</option>
                            <option value="az">Azərbaycanca</option>
                            <option value="tr">Türkçe</option>
                        </select>
                    </div>
                    <div class="background-switcher-container">
                        <label for="backgroundSelector" data-translate-key="backgroundLabel">Background:</label>
                        <select id="backgroundSelector" title="Select Background">
                            <option value="night" data-translate-key="backgroundNight">Night Sky</option>
                            <option value="faulty-terminal" data-translate-key="backgroundFaultyTerminal">Faulty Terminal</option>
                            <option value="dot-grid" data-translate-key="backgroundDotGrid">Dot Grid</option>
                            <option value="aurora" data-translate-key="backgroundAurora">Aurora</option>
                            <option value="dither" data-translate-key="backgroundDither">Dither</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="app-container">
        <section id="downloaderContent" class="main-card">
            <div class="text-center mb-8 sm:mb-10">
                <div class="music-icon-animated inline-block mb-4">
                    <svg width="60" height="50" viewBox="0 0 60 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <line x1="5" y1="45" x2="5" y2="5" stroke="#0ea5e9" stroke-width="4" stroke-linecap="round"/>
                        <line x1="15" y1="45" x2="15" y2="15" stroke="#0ea5e9" stroke-width="4" stroke-linecap="round"/>
                        <line x1="25" y1="45" x2="25" y2="25" stroke="#0ea5e9" stroke-width="4" stroke-linecap="round"/>
                        <line x1="35" y1="45" x2="35" y2="10" stroke="#0ea5e9" stroke-width="4" stroke-linecap="round"/>
                        <line x1="45" y1="45" x2="45" y2="20" stroke="#0ea5e9" stroke-width="4" stroke-linecap="round"/>
                        <line x1="55" y1="45" x2="55" y2="30" stroke="#0ea5e9" stroke-width="4" stroke-linecap="round"/>
                    </svg>
                </div>
                <h1 data-translate-key="headerH1" class="text-4xl sm:text-5xl font-extrabold text-sky-400 tracking-tight">Music Jacker</h1>
                <p data-translate-key="headerP" class="text-slate-400 mt-3 text-lg">Paste a YouTube, YouTube Music or SoundCloud link</p>
            </div>

            <form id="downloadForm" class="space-y-6">
                <div>
                    <label for="youtube_url" data-translate-key="urlLabel" class="block text-sm font-medium text-slate-300 mb-2">YouTube/YouTube Music/SoundCloud Link:</label>
                    <input
                        type="url"
                        id="youtube_url"
                        name="youtube_url"
                        required
                        class="w-full px-4 py-3 bg-slate-700/70 border-2 border-slate-600 rounded-lg text-white placeholder-slate-500 focus:ring-0 focus:border-sky-500 transition duration-200 ease-in-out"
                        data-translate-placeholder="urlPlaceholder"
                        placeholder="e.g., https://music.youtube.com/watch?v=... or https://soundcloud.com/track"
                    >
                </div>

                <div>
                    <label for="format_choice" data-translate-key="formatLabel" class="block text-sm font-medium text-slate-300 mb-2">Select format:</label>
                    <select
                        id="format_choice"
                        name="format_choice"
                        class="w-full px-4 py-3 bg-slate-700/70 border-2 border-slate-600 rounded-lg text-white focus:ring-0 focus:border-sky-500 transition duration-200 ease-in-out"
                    >
                        <option value="mp3" selected data-translate-key="formatMp3">MP3 (recommended)</option>
                        <option value="m4a" data-translate-key="formatM4a">M4A (Apple AAC)</option>
                        <option value="opus" data-translate-key="formatOpus">Opus (high efficiency)</option>
                        <option value="mp4" data-translate-key="formatMp4">MP4 (video 720p)</option>
                    </select>
                </div>

                <button
                    type="submit"
                    id="submitButton"
                    data-translate-key="submitButton"
                    class="submit-button w-full bg-sky-500 hover:bg-sky-400 text-slate-900 font-semibold py-3.5 px-4 rounded-lg shadow-lg focus:outline-none focus:ring-4 focus:ring-sky-500/50"
                >
                    Download
                </button>
            </form>

            <div id="statusArea" class="mt-8 text-center min-h-[60px]"></div>

            <div id="telegramLinkContainer" class="telegram-link-container text-center hidden">
                <p>
                    <span data-translate-key="telegramSubscription">Subscribe to Telegram Channel of developers:</span>
                    <a href="https://t.me/ytdlpdeveloper" target="_blank" rel="noopener noreferrer">@ytdlpdeveloper</a>
                </p>
                <p class="mt-2">
                    <span data-translate-key="telegramBotAlternative">Telegram bot alternative:</span>
                    <a href="https://t.me/ytdlpload_bot" target="_blank" rel="noopener noreferrer">@ytdlpload_bot</a>
                </p>
            </div>
        </section>
    </main>

    <footer class="app-footer text-center text-slate-500 text-sm">
        <p data-translate-key="footerCopyrightText">© <span id="year"></span> Music Jacker. Site made by thebitsamurai.</p>
        <p class="text-xs mt-1" data-translate-key="footerWatermark">Developed By thebitsamurai</p>
    </footer>

    <section id="infoSectionOverlay" class="overlay-section">
        <button id="closeInfoButton" class="close-overlay-button" aria-label="Close Info">×</button>
        <div class="info-content-card">
            <h2 data-translate-key="infoTitle">Information</h2>
            <h3 data-translate-key="infoHowItWorksTitle">How This Site Works</h3>
            <p data-translate-key="infoHowItWorksPara1">This web application allows you to download audio/video from YouTube, SoundCloud or other videos/tracks or playlists. You simply paste the URL, choose your desired format (MP3, M4A, Opus or MP4), and the server-side script processes your request.</p>
            <p data-translate-key="infoHowItWorksPara2">The backend uses the powerful <code>yt-dlp</code> library to fetch content information and extract the audio/video stream. If MP3, M4A, Opus or MP4 format is selected, <code>ffmpeg</code> is used for conversion and to embed metadata.</p>
            <p data-translate-key="infoHowItWorksPara3">The downloaded file is temporarily stored on the server and then made available for you to download directly through your browser. After the download is served to you, the file is automatically deleted from the server to save space and ensure privacy.</p>

            <h3 data-translate-key="infoLibrariesTitle">Key Libraries & Technologies Used</h3>
            <ul>
                <li data-translate-key="infoLibFlask"><strong>Flask:</strong> A micro web framework for Python, used to build the backend API.</li>
                <li data-translate-key="infoLibYtdlp"><strong>yt-dlp:</strong> A command-line program to download videos/audio from YouTube, SoundCloud and many other sites. It's a fork of youtube-dl with additional features and fixes.</li>
                <li data-translate-key="infoLibFFmpeg"><strong>FFmpeg:</strong> A complete, cross-platform solution to record, convert and stream audio and video. Used here for format conversion (to MP3/M4A/Opus/MP4) and metadata embedding.</li>
                <li data-translate-key="infoLibTailwind"><strong>Tailwind CSS:</strong> A utility-first CSS framework for rapidly building custom user interfaces.</li>
                <li data-translate-key="infoLibJS"><strong>JavaScript:</strong> Used for frontend interactivity, language switching, animations, and communication with the backend API.</li>
            </ul>

            <h3 data-translate-key="infoPythonCodeTitle">Python Backend Code</h3>
            <p data-translate-key="infoPythonCodePara">The core backend logic is written in Python using the Flask framework. The Python script (typically named <code>app.py</code>) handles API requests, interacts with <code>yt-dlp</code> and <code>ffmpeg</code>, manages temporary file storage, and serves the files. This code runs on the server and is not directly visible here, but it ensures the functionality of the downloader.</p>

            <h3 data-translate-key="infoCreatorTitle">Creator</h3>
            <p data-translate-key="infoCreatorName">This Music Jacker site was created by <strong>thebitsamurai</strong>.</p>
        </div>
    </section>

    <section id="copyrightSectionOverlay" class="overlay-section">
        <button id="closeCopyrightButton" class="close-overlay-button" aria-label="Close Copyright">×</button>
        <div class="info-content-card">
            <h2 data-translate-key="copyrightTitle">Copyright & Responsibility</h2>
            <p data-translate-key="copyrightPara1">Please be aware that music and other audio content available on YouTube, SoundCloud and other platforms may be protected by copyright. Many artists and content creators have specific licenses and terms of use for their work. It is your responsibility to ensure that you have the necessary rights or permissions before downloading any content.</p>
            <p data-translate-key="copyrightPara2">The developer of this site provides this tool for convenience and is not responsible for the content you choose to download or how you use it. By using this service, you agree that you are solely responsible for your actions and for complying with all applicable copyright laws and terms of service of the content providers.</p>
        </div>
    </section>

    <script>
const translations = {
            en: {
                pageTitle: "YouTube, YouTube Music & SoundCloud Downloader by thebitsamurai",
                metaDescriptionContent: "Easily download music and video from YouTube, YouTube Music, SoundCloud and other videos/tracks and playlists in MP3, M4A, Opus or MP4 formats. Created by thebitsamurai.",
                navInfoButton: "Info",
                navCopyrightButton: "Copyright",
                navUpdatesButton: "Updates (Blog)",
                navGithubButton: "GitHub",
                infoTitle: "About This Site",
                infoHowItWorksTitle: "How This Site Works",
                infoHowItWorksPara1: "This web application allows you to download audio/video from YouTube, YouTube Music, SoundCloud or other videos/tracks or playlists. You simply paste the URL, choose your desired format (MP3, M4A, Opus or MP4), and the server-side script processes your request.",
                infoHowItWorksPara2: "The backend uses the powerful <code>yt-dlp</code> library to fetch content information and extract the audio/video stream. If MP3, M4A, Opus or MP4 format is selected, <code>ffmpeg</code> is used for conversion and to embed metadata.",
                infoHowItWorksPara3: "The downloaded file is temporarily stored on the server and then made available for you to download directly through your browser. After the download is served to you, the file is automatically deleted from the server to save space and ensure privacy.",
                infoLibrariesTitle: "Key Libraries & Technologies Used",
                infoLibFlask: "<strong>Flask:</strong> A micro web framework for Python, used to build the backend API.",
                infoLibYtdlp: "<strong>yt-dlp:</strong> A command-line program to download videos/audio from YouTube, YouTube Music, SoundCloud and many other sites. It's a fork of youtube-dl with additional features and fixes.",
                infoLibFFmpeg: "<strong>FFmpeg:</strong> A complete, cross-platform solution to record, convert and stream audio and video. Used here for format conversion (to MP3/M4A/Opus/MP4) and metadata embedding.",
                infoLibTailwind: "<strong>Tailwind CSS:</strong> A utility-first CSS framework for rapidly building custom user interfaces.",
                infoLibJS: "<strong>JavaScript:</strong> Used for frontend interactivity, language switching, animations, and communication with the backend API.",
                infoPythonCodeTitle: "Python Backend Code",
                infoPythonCodePara: "The core backend logic is written in Python using the Flask framework. The Python script (typically named <code>app.py</code>) handles API requests, interacts with <code>yt-dlp</code> and <code>ffmpeg</code>, manages temporary file storage, and serves the files. This code runs on the server and is not directly visible here, but it ensures the functionality of the downloader.",
                copyrightTitle: "Copyright & Responsibility",
                copyrightPara1: "Please be aware that music and other audio content available on YouTube, SoundCloud and other platforms may be protected by copyright. Many artists and content creators have specific licenses and terms of use for their work. It is your responsibility to ensure that you have the necessary rights or permissions before downloading any content.",
                copyrightPara2: "The developer of this site provides this tool for convenience and is not responsible for the content you choose to download or how you use it. By using this service, you agree that you are solely responsible for your actions and for complying with all applicable copyright laws and terms of service of the content providers.",
                infoCreatorTitle: "Creator",
                infoCreatorName: "This Music Jacker site was created by <strong>thebitsamurai</strong>.",
                headerH1: "Music Jacker",
                headerP: "Paste a YouTube, YouTube Music or SoundCloud video/track or playlist link",
                urlLabel: "YouTube/YouTube Music/SoundCloud Link:",
                urlPlaceholder: "e.g., https://music.youtube.com/watch?v=... or https://soundcloud.com/track",
                formatLabel: "Select format:",
                formatMp3: "MP3 (recommended)",
                formatM4a: "M4A (Apple AAC)",
                formatOpus: "Opus (high efficiency)",
                formatMp4: "MP4 (video 720p)",
                submitButton: "Download",
                footerCopyrightText: "YouTube, YouTube Music, SoundCloud & Other downloader. Site made by thebitsamurai.",
                footerWatermark: "Developed By thebitsamurai",
                statusErrorUrl: "Please enter a valid YouTube, YouTube Music or SoundCloud URL.",
                statusProcessing: "Processing link... Please wait.",
                statusSuccessHeader: "Done! Initiating downloads:",
                statusDownloadLinkText: "Download {FORMAT}",
                statusPostDownloadHint: "If downloads didn't start, check browser pop-up settings or file save location.",
                statusErrorGeneric: "Error: {MESSAGE}",
                statusNetworkError: "A network error occurred. Please try again.",
                backgroundLabel: "Background:",
                backgroundNight: "Night Sky",
                backgroundFaultyTerminal: "Faulty Terminal",
                backgroundDotGrid: "Dot Grid",
                backgroundAurora: "Aurora",
                backgroundDither: "Dither",
                languageLabel: "Language:",
                telegramSubscription: "Subscribe to Telegram Channel of developers:",
                telegramBotAlternative: "Telegram bot alternative:",
                fileStatusPending: "Pending...",
                fileStatusDownloading: "Downloading...",
                fileStatusStarted: "Started! Check browser.",
                durationLimitInfo: "Note: Content longer than 10 minutes cannot be downloaded.",
                durationLimitError: "Content longer than 10 minutes cannot be downloaded.",
                playlistDurationLimitError: "Playlist contains content longer than 10 minutes, which cannot be downloaded."
            },
            ru: {
                pageTitle: "Загрузчик музыки с YouTube, YouTube Music, SoundCloud и других сайтов от thebitsamurai",
                metaDescriptionContent: "Легко скачивайте музыку и видео из видео/треков и плейлистов YouTube, YouTube Music, SoundCloud и других сайтов в форматах MP3, M4A, Opus или MP4. Создано thebitsamurai.",
                navInfoButton: "Инфо",
                navCopyrightButton: "Авторское право",
                navUpdatesButton: "Обновления (Блог)",
                navGithubButton: "GitHub",
                infoTitle: "Об этом сайте",
                infoHowItWorksTitle: "Как работает этот сайт",
                infoHowItWorksPara1: "Это веб-приложение позволяет загружать аудио/видео из видео/треков или плейлистов YouTube, YouTube Music, SoundCloud или других сайтов. Вы просто вставляете URL-адрес, выбираете желаемый формат (MP3, M4A, Opus или MP4), и серверный скрипт обрабатывает ваш запрос.",
                infoHowItWorksPara2: "Бэкенд использует мощную библиотеку <code>yt-dlp</code> для получения информации о контенте и извлечения аудио/видеопотока. Если выбран формат MP3, M4A, Opus или MP4, для преобразования и встраивания метаданных используется <code>ffmpeg</code>.",
                infoHowItWorksPara3: "Загруженный файл временно сохраняется на сервере, а затем становится доступным для прямой загрузки через ваш браузер. После того как файл передан вам, он автоматически удаляется с сервера для экономии места и обеспечения конфиденциальности.",
                infoLibrariesTitle: "Ключевые библиотеки и технологии",
                infoLibFlask: "<strong>Flask:</strong> Микрофреймворк для веб-разработки на Python, используемый для создания бэкенд API.",
                infoLibYtdlp: "<strong>yt-dlp:</strong> Программа командной строки для загрузки видео/аудио с YouTube, YouTube Music, SoundCloud и многих других сайтов. Это форк youtube-dl с дополнительными функциями и исправлениями.",
                infoLibFFmpeg: "<strong>FFmpeg:</strong> Полное кроссплатформенное решение для записи, преобразования и потоковой передачи аудио и видео. Здесь используется для конвертации форматов (в MP3/M4A/Opus/MP4) и встраивания метаданных.",
                infoLibTailwind: "<strong>Tailwind CSS:</strong> Утилитарный CSS-фреймворк для быстрой разработки пользовательских интерфейсов.",
                infoLibJS: "<strong>JavaScript:</strong> Используется для интерактивности фронтенда, переключения языков, анимаций и взаимодействия с бэкенд API.",
                infoPythonCodeTitle: "Код бэкенда на Python",
                infoPythonCodePara: "Основная логика бэкенда написана на Python с использованием фреймворка Flask. Python-скрипт (обычно с именем <code>app.py</code>) обрабатывает API-запросы, взаимодействует с <code>yt-dlp</code> и <code>ffmpeg</code>, управляет временным хранением файлов и отдает файлы. Этот код выполняется на сервере и здесь не отображается напрямую, но он обеспечивает работоспособность загрузчика.",
                copyrightTitle: "Авторские права и ответственность",
                copyrightPara1: "Пожалуйста, имейте в виду, что музыка и другой аудиоконтент, доступный на YouTube, SoundCloud и других платформах, может быть защищен авторским правом. Многие исполнители и создатели контента имеют особые лицензии и условия использования своих произведений. Вы несете ответственность за то, чтобы у вас были необходимые права или разрешения перед загрузкой любого контента.",
                copyrightPara2: "Разработчик этого сайта предоставляет данный инструмент для удобства и не несет ответственности за контент, который вы решите загрузить, или за то, как вы его используете. Используя этот сервис, вы соглашаетесь с тем, что несете полную ответственность за свои действия и за соблюдение всех применимых законов об авторском праве и условий обслуживания поставщиков контента.",
                infoCreatorTitle: "Создатель",
                infoCreatorName: "Этот сайт для загрузки музыки с YouTube, YouTube Music и SoundCloud был создан <strong>thebitsamurai</strong>.",
                headerH1: "Загрузчик Музыки",
                headerP: "Вставьте ссылку на YouTube, YouTube Music или SoundCloud (видео, трек или плейлист)",
                urlLabel: "Ссылка YouTube/YouTube Music/SoundCloud:",
                urlPlaceholder: "например, https://music.youtube.com/watch?v=... или https://soundcloud.com/track",
                formatLabel: "Выберите формат:",
                formatMp3: "MP3 (рекомендуется)",
                formatM4a: "M4A (Apple AAC)",
                formatOpus: "Opus (высокая эффективность)",
                formatMp4: "MP4 (видео 720p)",
                submitButton: "Скачать",
                footerCopyrightText: "Загрузчик музыки YouTube, YouTube Music, SoundCloud и других сайтов. Сайт сделан thebitsamurai.",
                footerWatermark: "Разработано thebitsamurai",
                statusErrorUrl: "Пожалуйста, введите корректную ссылку YouTube, YouTube Music или SoundCloud.",
                statusProcessing: "Обработка ссылки... Пожалуйста, подождите.",
                statusSuccessHeader: "Готово! Начинаю загрузку файла(ов):",
                statusDownloadLinkText: "Скачать {FORMAT}",
                statusPostDownloadHint: "Если загрузка не началась, проверьте настройки блокировки всплывающих окон или место сохранения файлов.",
                statusErrorGeneric: "Ошибка: {MESSAGE}",
                statusNetworkError: "Произошла сетевая ошибка. Пожалуйста, попробуйте еще раз.",
                backgroundLabel: "Фон:",
                backgroundNight: "Ночное небо",
                backgroundFaultyTerminal: "Faulty Terminal",
                backgroundDotGrid: "Сетка точек",
                backgroundAurora: "Аврора",
                backgroundDither: "Dither",
                languageLabel: "Язык:",
                telegramSubscription: "Подпишитесь на Telegram канал разработчиков:",
                telegramBotAlternative: "Альтернативный Telegram-бот:",
                fileStatusPending: "В ожидании...",
                fileStatusDownloading: "Загрузка...",
                fileStatusStarted: "Начато! Проверьте браузер.",
                durationLimitInfo: "Примечание: Контент длиннее 10 минут не может быть скачан.",
                durationLimitError: "Контент длиннее 10 минут не может быть скачан.",
                playlistDurationLimitError: "Плейлист содержит контент длиннее 10 минут, который не может быть скачан."
            },
            es: {
                pageTitle: "Descargador de Música de YouTube, YouTube Music, SoundCloud y otros sitios por thebitsamurai",
                metaDescriptionContent: "Descarga fácilmente música y video de videos/pistas y listas de reproducción de YouTube, YouTube Music, SoundCloud y otros sitios en formatos MP3, M4A, Opus o MP4. Creado por thebitsamurai.",
                navInfoButton: "Info",
                navCopyrightButton: "Copyright",
                navUpdatesButton: "Actualizaciones (Blog)",
                navGithubButton: "GitHub",
                infoTitle: "Sobre este Sitio",
                infoHowItWorksTitle: "Cómo Funciona Este Sitio",
                infoHowItWorksPara1: "Esta aplicación web te permite descargar audio/video de videos/pistas o listas de reproducción de YouTube, YouTube Music, SoundCloud u otros sitios. Simplemente pegas la URL, eliges tu formato deseado (MP3, M4A, Opus o MP4), y el script del lado del servidor procesa tu solicitud.",
                infoHowItWorksPara2: "El backend utiliza la potente biblioteca <code>yt-dlp</code> para obtener información del contenido y extraer el flujo de audio/video. Si se selecciona el formato MP3, M4A, Opus o MP4, se utiliza <code>ffmpeg</code> para la conversión e incrustación de metadatos.",
                infoHowItWorksPara3: "El archivo descargado se almacena temporalmente en el servidor y luego se pone a tu disposición para que lo descargues directamente a través de tu navegador. Después de que se te entrega la descarga, el archivo se elimina automáticamente del servidor para ahorrar espacio y garantizar la privacidad.",
                infoLibrariesTitle: "Bibliotecas Clave y Tecnologías Utilizadas",
                infoLibFlask: "<strong>Flask:</strong> Un microframework web para Python, utilizado para construir la API del backend.",
                infoLibYtdlp: "<strong>yt-dlp:</strong> Un programa de línea de comandos para descargar videos/audio de YouTube, YouTube Music, SoundCloud y muchos otros sitios. Es un fork de youtube-dl con características adicionales y correcciones.",
                infoLibFFmpeg: "<strong>FFmpeg:</strong> Una solución completa y multiplataforma para grabar, convertir y transmitir audio y video. Se utiliza aquí para la conversión de formato (a MP3/M4A/Opus/MP4) e incrustación de metadatos.",
                infoLibTailwind: "<strong>Tailwind CSS:</strong> A utility-first CSS framework for rapidly building custom user interfaces.",
                infoLibJS: "<strong>JavaScript:</strong> Utilizado para la interactividad del frontend, cambio de idioma, animaciones y comunicación con the backend API.",
                infoPythonCodeTitle: "Código Backend en Python",
                infoPythonCodePara: "La lógica central del backend está escrita en Python utilizando el framework Flask. El script de Python (generalmente llamado <code>app.py</code>) handles API requests, interacts with <code>yt-dlp</code> and <code>ffmpeg</code>, manages temporary file storage, and serves the files. This code runs on the server and is not directly visible here, but it ensures the functionality of the downloader.",
                copyrightTitle: "Derechos de Autor y Responsabilidad",
                copyrightPara1: "Tenga en cuenta que la música y otro contenido de audio disponible en YouTube, SoundCloud y otras plataformas may be protected by copyright. Many artists and content creators have specific licenses and terms of use for their work. It is your responsibility to ensure that you have the necessary rights or permissions before downloading any content.",
                copyrightPara2: "El desarrollador de este sitio proporciona esta herramienta para conveniencia y no es responsable del contenido que elija descargar ni de cómo lo utilice. Al utilizar este servicio, usted acepta que es el único responsable de sus acciones y de cumplir con todas las leyes de derechos de autor aplicables y los términos de servicio de los proveedores de contenido.",
                infoCreatorTitle: "Creador",
                infoCreatorName: "Este sitio de Descarga de Música de YouTube, YouTube Music y SoundCloud fue creado por <strong>thebitsamurai</strong>.",
                headerH1: "Music Jacker",
                headerP: "Pega un enlace de video/pista o lista de reproducción de YouTube, YouTube Music o SoundCloud",
                urlLabel: "Enlace de YouTube/YouTube Music/SoundCloud:",
                urlPlaceholder: "ej., https://music.youtube.com/watch?v=... o https://soundcloud.com/track",
                formatLabel: "Seleccionar formato:",
                formatMp3: "MP3 (recomendado)",
                formatM4a: "M4A (Apple AAC)",
                formatOpus: "Opus (alta eficiencia)",
                formatMp4: "MP4 (video 720p)",
                submitButton: "Descargar",
                footerCopyrightText: "Descargador de música de YouTube, YouTube Music, SoundCloud y otros sitios. Sitio hecho por thebitsamurai.",
                footerWatermark: "Desarrollado por thebitsamurai",
                statusErrorUrl: "Por favor, introduce una URL válida de YouTube, YouTube Music o SoundCloud.",
                statusProcessing: "Procesando enlace... Por favor, espera.",
                statusSuccessHeader: "¡Listo! Iniciando descargas:",
                statusDownloadLinkText: "Descargar {FORMAT}",
                statusPostDownloadHint: "Si las descargas no comenzaron, revisa la configuración de ventanas emergentes del navegador o la ubicación de guardado de archivos.",
                statusErrorGeneric: "Error: {MESSAGE}",
                statusNetworkError: "Ocurrió un error de red. Por favor, inténtalo de nuevo.",
                backgroundLabel: "Fondo:",
                backgroundNight: "Cielo nocturno",
                backgroundFaultyTerminal: "Terminal defectuosa",
                backgroundDotGrid: "Cuadrícula de puntos",
                backgroundAurora: "Aurora",
                backgroundDither: "Dither",
                languageLabel: "Idioma:",
                telegramSubscription: "Suscríbete al canal de Telegram de los desarrolladores:",
                telegramBotAlternative: "Alternativa de bot de Telegram:",
                fileStatusPending: "Pendiente...",
                fileStatusDownloading: "Descargando...",
                fileStatusStarted: "¡Iniciado! Revisa el navegador.",
                durationLimitInfo: "Nota: El contenido de más de 10 minutos no se puede descargar.",
                playlistDurationLimitError: "La lista de reproducción contiene contenido de más de 10 minutos, que no se puede descargar."
            },
            az: {
                pageTitle: "thebitsamurai tərəfindən YouTube, YouTube Music, SoundCloud və digər saytlar üçün Yükləyici",
                metaDescriptionContent: "YouTube, YouTube Music, SoundCloud və digər saytlardan videolar/treklər və pleylistlərdən musiqi və video faylları MP3, M4A, Opus və ya MP4 formatlarında asanlıqla yükləyin. thebitsamurai tərəfindən yaradılıb.",
                navInfoButton: "Məlumat",
                navCopyrightButton: "Müəllif Hüquqları",
                navUpdatesButton: "Yenilikler (Bloq)",
                navGithubButton: "GitHub",
                infoTitle: "Bu Sayt Haqqında",
                infoHowItWorksTitle: "Bu Sayt Necə İşləyir",
                infoHowItWorksPara1: "Bu veb tətbiqi YouTube, YouTube Music, SoundCloud və ya digər saytlardan videolar/treklər və ya pleylistlərdən audio/video yükləməyə imkan verir. Siz sadəcə URL-ni daxil edir, istədiyiniz formatı (MP3, M4A, Opus və ya MP4) seçirsiniz və server tərəfi skripti sorğunu emal edir.",
                infoHowItWorksPara2: "Backend məzmun məlumatlarını əldə etmək və audio/video axınını çıxarmaq üçün güclü <code>yt-dlp</code> kitabxanasından istifadə edir. MP3, M4A, Opus və ya MP4 formatı seçildikdə, çevrilmə və metadatanın daxil edilməsi üçün <code>ffmpeg</code> istifadə olunur.",
                infoHowItWorksPara3: "Yüklənmiş fayl müvəqqəti olaraq serverdə saxlanılır və sonra brauzeriniz vasitəsilə birbaşa yükləmək üçün sizə təqdim olunur. Fayl sizə təqdim edildikdən sonra, yerə qənaət etmək və məxfiliyi təmin etmək üçün avtomatik olaraq serverdən silinir.",
                infoLibrariesTitle: "Əsas Kitabxanalar və Texnologiyalar",
                infoLibFlask: "<strong>Flask:</strong> Backend API qurmaq üçün istifadə olunan Python üçün mikro veb freymvorku.",
                infoLibYtdlp: "<strong>yt-dlp:</strong> YouTube, YouTube Music, SoundCloud və bir çox başqa saytlardan video/audio yükləmək üçün əmr sətiri proqramı. Bu, əlavə funksiyalar və düzəlişlərlə youtube-dl-in bir forkudur.",
                infoLibFFmpeg: "<strong>FFmpeg:</strong> Audio və video yazmaq, çevirmək və yayımlamaq üçün tam, çarpaz platformalı bir həll. Burada formatların çevrilməsi (MP3/M4A/Opus/MP4-ə) və metadatanın daxil edilməsi üçün istifadə olunur.",
                infoLibTailwind: "<strong>Tailwind CSS:</strong> Xüsusi istifadəçi interfeyslərini sürətlə qurmaq üçün utilitar CSS freymvorku.",
                infoLibJS: "<strong>JavaScript:</strong> Frontend interaktivliyi, dil dəyişdirmə, animasiyalar və backend API ilə əlaqə üçün istifadə olunur.",
                infoPythonCodeTitle: "Python Backend Kodu",
                infoPythonCodePara: "Əsas backend məntiqi Flask freymvorkundan istifadə edərək Python-da yazılmışdır. Python skripti (adətən <code>app.py</code> adlanır) API sorğularını idarə edir, <code>yt-dlp</code> və <code>ffmpeg</code> ilə qarşılıqlı əlaqədə olur, müvəqqəti fayl saxlanmasını idarə edir və faylları təqdim edir. Bu kod serverdə işləyir və burada birbaşa görünmür, lakin yükləyicinin funksionallığını təmin edir.",
                copyrightTitle: "Müəllif Hüquqları və Məsuliyyət",
                copyrightPara1: "Nəzərə alın ki, YouTube, SoundCloud və digər platformalarda mövcud olan musiqi və digər audio məzmun müəllif hüquqları ilə qoruna bilər. Bir çox sənətçi və məzmun yaradıcısının əsərləri üçün xüsusi lisenziyaları və istifadə şərtləri var. Hər hansı bir məzmunu yükləməzdən əvvəl lazımi hüquqlara və ya icazələrə sahib olduğunuzdan əmin olmaq sizin məsuliyyətinizdir.",
                copyrightPara2: "Bu saytın tərtibatçısı bu aləti rahatlıq üçün təqdim edir və yükləməyi seçdiyiniz məzmuna və ya ondan necə istifadə etdiyinizə görə məsuliyyət daşımır. Bu xidmətdən istifadə etməklə, hərəkətlərinizə və bütün tətbiq olunan müəllif hüquqları qanunlarına və məzmun təminatçılarının xidmət şərtlərininə riayət etməyə görə yalnız sizin məsuliyyət daşıdığınızı qəbul edirsiniz.",
                infoCreatorTitle: "Yaradıcı",
                infoCreatorName: "Bu YouTube, YouTube Music və SoundCloud Yükləyicisi saytı <strong>thebitsamurai</strong> tərəfindən yaradılmışdır.",
                headerH1: "Musiqi Yükləyicisi",
                headerP: "YouTube, YouTube Music və ya SoundCloud keçidini daxil edin",
                urlLabel: "YouTube/YouTube Music/SoundCloud keçidi:",
                urlPlaceholder: "məsələn, https://music.youtube.com/watch?v=... və ya https://soundcloud.com/track",
                formatLabel: "Format seçin:",
                formatMp3: "MP3 (tövsiyə olunur)",
                formatM4a: "M4A (Apple AAC)",
                formatOpus: "Opus (yüksək səmərəlilik)",
                formatMp4: "MP4 (video 720p)",
                submitButton: "Yüklə",
                footerCopyrightText: "YouTube, YouTube Music, SoundCloud və digər saytlar üçün musiqi yükləyicisi. Sayt thebitsamurai tərəfindən hazırlanıb.",
                footerWatermark: "thebitsamurai tərəfindən hazırlanıb",
                statusErrorUrl: "Zəhmət olmasa, YouTube, YouTube Music və ya SoundCloud üçün düzgün URL daxil edin.",
                statusProcessing: "Keçid emal olunur... Zəhmət olmasa, gözləyin.",
                statusSuccessHeader: "Hazırdır! Yükləmələr başlayır:",
                statusDownloadLinkText: "{FORMAT} Yüklə",
                statusPostDownloadHint: "Əgər yükləmələr başlamadısa, brauzerin pop-up parametrlərini və ya faylın yadda saxlanma yerini yoxlayın.",
                statusErrorGeneric: "Xəta: {MESSAGE}",
                statusNetworkError: "Şəbəkə xətası baş verdi. Zəhmət olmasa, yenidən cəhd edin.",
                backgroundLabel: "Fon:",
                backgroundNight: "Gecə səması",
                backgroundFaultyTerminal: "Nasaz Terminal",
                backgroundDotGrid: "Nöqtə şəbəkəsi",
                backgroundAurora: "Aurora",
                backgroundDither: "Dither",
                backgroundLabel: "Arka plan:",
                backgroundNight: "Gece gökyüzü",
                backgroundFaultyTerminal: "Arızalı Terminal",
                backgroundDotGrid: "Nokta ızgarası",
                backgroundAurora: "Aurora",
                backgroundDither: "Dither",
                languageLabel: "Dil:",
                telegramSubscription: "İstehsalçıların Telegram kanalına abunə olun:",
                telegramBotAlternative: "Telegram bot alternativi:",
                fileStatusPending: "Gözlənilir...",
                fileStatusDownloading: "Yüklənir...",
                fileStatusStarted: "Başladı! Brauzeri yoxlayın.",
                durationLimitInfo: "Qeyd: 10 dəqiqədən uzun məzmun yüklənə bilməz.",
                durationLimitError: "10 dəqiqədən uzun məzmun yüklənə bilməz.",
                playlistDurationLimitError: "Pleylistdə 10 dəqiqədən uzun məzmun var, bu yüklənə bilməz."
            },
            tr: {
                pageTitle: "thebitsamurai'dan YouTube, YouTube Music, SoundCloud ve Diğer Siteler İçin İndirici",
                metaDescriptionContent: "YouTube, YouTube Music, SoundCloud ve diğer sitelerden videolar/şarkılar ve çalma listelerinden MP3, M4A, Opus veya MP4 formatında kolayca müzik ve video indirin. thebitsamurai tarafından oluşturuldu.",
                navInfoButton: "Bilgi",
                navCopyrightButton: "Telif Hakkı",
                navUpdatesButton: "Güncellemeler (Blog)",
                navGithubButton: "GitHub",
                infoTitle: "Bu Site Hakkında",
                infoHowItWorksTitle: "Bu Site Nasıl Çalışır?",
                infoHowItWorksPara1: "Bu web uygulaması, YouTube, YouTube Music, SoundCloud veya diğer sitelerden videolar/şarkılar veya oynatma listelerinden ses/video indirmenizi sağlar. URL'yi yapıştırır, istediğiniz formatı (MP3, M4A, Opus veya MP4) seçersiniz ve sunucu tarafı betiği isteğinizi işler.",
                infoHowItWorksPara2: "Arka uç, içerik bilgilerini almak ve ses/video akışını çıkarmak için güçlü <code>yt-dlp</code> kitaplığını kullanır. MP3, M4A, Opus veya MP4 formatı seçilirse, dönüştürme ve meta veri gömme için <code>ffmpeg</code> kullanılır.",
                infoHowItWorksPara3: "İndirilen dosya geçici olarak sunucuda saklanır ve ardından tarayıcınız üzerinden doğrudan indirmeniz için kullanıma sunulur. İndirme size sunulduktan sonra, yerden tasarruf etmek ve gizliliği sağlamak için dosya sunucudan otomatik olarak silinir.",
                infoLibrariesTitle: "Kullanılan Temel Kitaplıklar ve Teknolojiler",
                infoLibFlask: "<strong>Flask:</strong> Arka uç API'sini oluşturmak için Python için bir mikro web çerçevesi.",
                infoLibYtdlp: "<strong>yt-dlp:</strong> YouTube, YouTube Music, SoundCloud ve birçok diğer siteden video/ses indirmek için komut satırı programı. youtube-dl'nin ek özellikler ve düzeltmeler içeren bir forkudur.",
                infoLibFFmpeg: "<strong>FFmpeg:</strong> Ses ve videoyu kaydetmek, dönüştürmek ve yayınlamak için eksiksiz, çok platformlu bir çözümdür. Burada format dönüşümü (MP3/M4A/Opus/MP4) ve meta veri gömme için kullanılır.",
                infoLibTailwind: "<strong>Tailwind CSS:</strong> A utility-first CSS framework for rapidly building custom user interfaces.",
                infoLibJS: "<strong>JavaScript:</strong> Ön uç etkileşimi, dil değiştirme, animasyonlar ve arka uç API ile iletişim için kullanılır.",
                infoPythonCodeTitle: "Python Arka Uç Kodu",
                infoPythonCodePara: "Temel arka uç mantığı, Flask çerçevesi kullanılarak Python ile yazılmıştır. Python betiği (genellikle <code>app.py</code> olarak adlandırılır) API isteklerini işler, <code>yt-dlp</code> и <code>ffmpeg</code> ile etkileşime girer, geçici dosya depolamasını yönetir и dosyaları sunar. Bu kod sunucuda çalışır и здесь doğrudan görünmez, однако indiricinin işlevselliğini sağlar.",
                copyrightTitle: "Telif Hakkı и Sorumluluk",
                copyrightPara1: "Lütfen YouTube, SoundCloud и diğer platformlarda bulunan müzik и diğer ses içeriklerinin telif hakkıyla korunuyor olabileceğini unutmayın. Birçok sanatçı и içerik oluşturucunun eserleri için özel lisansları и kullanım koşulları vardır. Herhangi bir içeriği indirmeden önce gerekli haklara veya izinlere sahip olduğunuzdan emin olmak sizin sorumluluğunuzdadır.",
                copyrightPara2: "Bu sitenin geliştiricisi, bu aracı kolaylık sağlamak amacıyla sunar и indirmeyi seçtiğiniz içerikten veya onu nasıl kullandığınızdan sorumlu değildir. Bu hizmeti kullanarak, eylemlerinizden и geçerli tüm telif hakkı yasalarına и içerik sağlayıcıların hizmet şartlarına uymaktan yalnızca sizin sorumluluğunuzdadır.",
                infoCreatorTitle: "Oluşturan",
                infoCreatorName: "Bu YouTube, YouTube Music ve SoundCloud İndirici sitesi <strong>thebitsamurai</strong> tarafından oluşturulmuştur.",
                headerH1: "Music Jacker",
                headerP: "YouTube, YouTube Music veya SoundCloud bağlantısı yapıştırın",
                urlLabel: "YouTube/YouTube Music/SoundCloud bağlantısı:",
                urlPlaceholder: "örneğin, https://music.youtube.com/watch?v=... veya https://soundcloud.com/track",
                formatLabel: "Format seçin:",
                formatMp3: "MP3 (önerilir)",
                formatM4a: "M4A (Apple AAC)",
                formatOpus: "Opus (yüksek verimlilik)",
                formatMp4: "MP4 (video 720p)",
                submitButton: "İndir",
                footerCopyrightText: "YouTube, YouTube Music, SoundCloud ve Diğer İndirici. Site thebitsamurai tarafından yapıldı.",
                footerWatermark: "thebitsamurai tarafından geliştirildi",
                statusErrorUrl: "Lütfen geçerli bir YouTube, YouTube Music veya SoundCloud URL'si girin.",
                statusProcessing: "Bağlantı işleniyor... Lütfen bekleyin.",
                statusSuccessHeader: "Tamamlandı! İndirmeler başlatılıyor:",
                statusDownloadLinkText: "{FORMAT} İndir",
                statusPostDownloadHint: "İndirmeler başlamadıysa, tarayıcının pop-up ayarlarını veya dosya kaydetme konumunu kontrol edin.",
                statusErrorGeneric: "Hata: {MESSAGE}",
                statusNetworkError: "Bir ağ hatası oluştu. Lütfen tekrar deneyin.",
                languageLabel: "Dil:",
                telegramSubscription: "Geliştiricilerin Telegram Kanalına Abone Olun:",
                telegramBotAlternative: "Telegram bot alternatifi:",
                fileStatusPending: "Beklemede...",
                fileStatusDownloading: "İndiriliyor...",
                fileStatusStarted: "Başladı! Tarayıcıyı kontrol et.",
                durationLimitInfo: "Not: 10 dakikadan uzun içerik indirilemez.",
                durationLimitError: "10 dakikadan uzun içerik indirilemez.",
                playlistDurationLimitError: "Çalma listesi 10 dakikadan uzun içerik barındırıyor, indirilemez."
            }
        };

        let currentLanguage = 'ru';

        function applyTranslations(lang) {
            currentLanguage = lang;
            localStorage.setItem('preferredLanguage', lang);
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

            document.title = getTranslation('pageTitle', lang);

            const metaDescElement = document.querySelector('meta[data-translate-meta-description]');
            if (metaDescElement) {
                metaDescElement.content = getTranslation('metaDescriptionContent', lang);
            }

            document.querySelectorAll('[data-translate-key]').forEach(element => {
                const key = element.getAttribute('data-translate-key');
                if (key === 'footerCopyrightText') {
                    const yearSpan = `<span id="year">${new Date().getFullYear()}</span>`;
                    element.innerHTML = getTranslation(key, lang).replace('<span id="year"></span>', yearSpan);
                } else {
                    element.innerHTML = getTranslation(key, lang);
                }
            });

            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                element.placeholder = getTranslation(key, lang);
            });

            const langSelector = document.getElementById('languageSelector');
            if (langSelector) {
                langSelector.value = lang;
            }

            window.reactbitsCurrentLanguage = lang;
            window.dispatchEvent(new CustomEvent('reactbits-language-change', { detail: lang }));
        }

        function getTranslation(key, lang = currentLanguage, replacements = {}) {
            let text = (translations[lang] && translations[lang][key]) ? translations[lang][key] : (translations.en[key] || key);
            for (const placeholder in replacements) {
                text = text.replace(`{${placeholder}}`, replacements[placeholder]);
            }
            return text;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const yearSpan = document.getElementById('year');
            if (yearSpan) {
                yearSpan.textContent = new Date().getFullYear();
            }

            const downloadForm = document.getElementById('downloadForm');
            const statusArea = document.getElementById('statusArea');
            const telegramLinkContainer = document.getElementById('telegramLinkContainer');
            const youtubeUrlInput = document.getElementById('youtube_url');
            const formatChoiceSelect = document.getElementById('format_choice');
            const languageSelector = document.getElementById('languageSelector');

            const infoButton = document.getElementById('infoButton');
            const infoSectionOverlay = document.getElementById('infoSectionOverlay');
            const closeInfoButton = document.getElementById('closeInfoButton');

            const copyrightButton = document.getElementById('copyrightButton');
            const copyrightSectionOverlay = document.getElementById('copyrightSectionOverlay');
            const closeCopyrightButton = document.getElementById('closeCopyrightButton');

            const updatesButton = document.getElementById('updatesButton');
            const githubButton = document.getElementById('githubButton');
            const backgroundSelector = document.getElementById('backgroundSelector');
            const backgroundModes = ['night', 'faulty-terminal', 'dot-grid', 'aurora', 'dither'];

            const preferredLang = localStorage.getItem('preferredLanguage');
            const browserLang = navigator.language.split('-')[0];
            let initialLang = 'ru';

            if (preferredLang && translations[preferredLang]) {
                initialLang = preferredLang;
            } else if (translations[browserLang]) {
                initialLang = browserLang;
            }

            applyTranslations(initialLang);

            function applyBackgroundChoice(mode) {
                const normalized = backgroundModes.includes(mode) ? mode : 'night';
                backgroundModes.forEach(bg => document.body.classList.remove(`bg-mode-${bg}`));
                document.body.classList.add(`bg-mode-${normalized}`);
                if (backgroundSelector) {
                    backgroundSelector.value = normalized;
                }
                try {
                    localStorage.setItem('preferredBackground', normalized);
                } catch (_) {
                }
            }

            let storedBackground = 'night';
            try {
                const savedBackground = localStorage.getItem('preferredBackground');
                if (savedBackground) {
                    storedBackground = savedBackground;
                }
            } catch (_) {
                storedBackground = 'night';
            }
            applyBackgroundChoice(storedBackground);

            if (backgroundSelector) {
                backgroundSelector.addEventListener('change', (event) => {
                    applyBackgroundChoice(event.target.value);
                });
            }

            function setupOverlay(button, overlay, closeButton) {
                if (button && overlay && closeButton) {
                    button.addEventListener('click', () => {
                        overlay.classList.add('visible');
                        document.body.classList.add('overflow-hidden');
                    });
                    closeButton.addEventListener('click', () => {
                        overlay.classList.remove('visible');
                        document.body.classList.remove('overflow-hidden');
                    });
                    overlay.addEventListener('click', (event) => {
                        if (event.target === overlay) {
                            overlay.classList.remove('visible');
                            document.body.classList.remove('overflow-hidden');
                        }
                    });
                } else {
                    console.error(`One or more elements for ${overlay ? overlay.id : 'an overlay'} functionality are missing:`,
                        {button, overlay, closeButton });
                }
            }

            setupOverlay(infoButton, infoSectionOverlay, closeInfoButton);
            setupOverlay(copyrightButton, copyrightSectionOverlay, closeCopyrightButton);

            if (updatesButton) {
                updatesButton.addEventListener('click', () => {
                    window.open('https://thebitsamuraii23.github.io/miniblog/', '_blank');
                });
            }

            if (githubButton) {
                githubButton.addEventListener('click', () => {
                    window.open('https://github.com/thebitsamuraii23/MusicJacker-Site', '_blank');
                });
            }


            if (languageSelector) {
                languageSelector.value = initialLang;
                languageSelector.addEventListener('change', (event) => {
                    applyTranslations(event.target.value);
                });
            }

            if (downloadForm) {
                downloadForm.addEventListener('submit', async function(event) {
                    event.preventDefault();
                    const url = youtubeUrlInput.value.trim();
                    const format = formatChoiceSelect.value;

                    if (telegramLinkContainer) telegramLinkContainer.classList.add('hidden');

                    if (!url) {
                        statusArea.innerHTML = `<p class="text-red-400 p-3 bg-red-900/30 rounded-md status-message-item">${getTranslation('statusErrorUrl')}</p>`;
                        return;
                    }
                     try {
                        new URL(url);
                    } catch (_) {
                        statusArea.innerHTML = `<p class="text-red-400 p-3 bg-red-900/30 rounded-md status-message-item">${getTranslation('statusErrorUrl')}</p>`;
                        return;
                    }

                    statusArea.innerHTML = `
                        <div class="flex flex-col justify-center items-center space-y-2 text-sky-400 p-3 status-message-item">
                            <div class="loader ease-linear rounded-full border-4 border-t-4 border-slate-600 h-8 w-8 mb-2"></div>
                            <span>${getTranslation('statusProcessing')}</span>
                        </div>`;

                    const submitButtonEl = document.getElementById('submitButton');
                    if(submitButtonEl) {
                        submitButtonEl.disabled = true;
                        submitButtonEl.classList.add('opacity-50', 'cursor-not-allowed');
                        submitButtonEl.classList.remove('hover:bg-sky-400', 'submit-button:hover');
                    }

                    try {
                        const response = await fetch('/api/download_audio', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ url: url, format: format }),
                        });

                        const contentType = response.headers.get("content-type");
                        if (!contentType || !contentType.includes("application/json")) {
                            const errorText = await response.text();
                            throw new Error(`Server returned an unexpected response: ${response.status} ${response.statusText}. ${errorText.substring(0,100)}`);
                        }
                        const data = await response.json();

                        if (response.ok && data.status === 'success' && data.files && data.files.length > 0) {
                            let filesListHtml = data.files.map((fileInfo, index) => `
                                <li id="file-item-${index}" class="bg-slate-700/60 p-3.5 rounded-lg shadow status-message-item flex justify-between items-center gap-3" style="animation-delay: ${index * 0.12}s">
                                    <div class="flex flex-col min-w-0">
                                        <span class="text-slate-300 block truncate" title="${fileInfo.title || ''}">${fileInfo.title || 'Untitled'} (${fileInfo.filename ? fileInfo.filename.split('.').pop().toUpperCase() : format.toUpperCase()})</span>
                                        ${fileInfo.artist ? `<span class="text-slate-400 text-xs truncate" title="${fileInfo.artist}">${fileInfo.artist}</span>` : ''}
                                    </div>
                                    <span id="file-status-${index}" class="file-download-status">${getTranslation('fileStatusPending')}</span>
                                </li>
                            `).join('');

                            statusArea.innerHTML = `
                                <div class="status-message-item">
                                    <p class="text-green-400 mb-3 text-lg">${getTranslation('statusSuccessHeader')}</p>
                                    <ul id="downloadQueueList" class="space-y-2.5 text-left max-h-60 overflow-y-auto pr-2">${filesListHtml}</ul>
                                    <p class="text-xs text-slate-500 mt-4">${getTranslation('statusPostDownloadHint')}</p>
                                </div>
                            `;
                            if (telegramLinkContainer) telegramLinkContainer.classList.remove('hidden');

                            (async () => {
                                for (let i = 0; i < data.files.length; i++) {
                                    const fileInfo = data.files[i];
                                    const fileStatusSpan = document.getElementById(`file-status-${i}`);

                                    if (fileStatusSpan) {
                                        fileStatusSpan.textContent = getTranslation('fileStatusDownloading');
                                        fileStatusSpan.className = 'file-download-status downloading';
                                    }

                                    const link = document.createElement('a');
                                    link.href = fileInfo.download_url;
                                    link.download = fileInfo.filename;
                                    document.body.appendChild(link);
                                    link.click();

                                    await new Promise(resolve => setTimeout(resolve, 5000));
                                    document.body.removeChild(link);

                                    if (fileStatusSpan) {
                                        fileStatusSpan.textContent = getTranslation('fileStatusStarted');
                                        fileStatusSpan.className = 'file-download-status completed';
                                    }

                                    if (i < data.files.length - 1) {
                                        await new Promise(resolve => setTimeout(resolve, 750));
                                    }
                                }
                            })();

                        } else {
                            if (data.message && (data.message.includes("Контент длиннее 10 минут") || data.message.includes("Плейлист содержит контент длиннее 10 минут"))) {
                                statusArea.innerHTML = `<p class="text-red-400 p-3 bg-red-900/30 rounded-md status-message-item">${data.message}</p>`;
                            } else {
                                statusArea.innerHTML = `<p class="text-red-400 p-3 bg-red-900/30 rounded-md status-message-item">${getTranslation('statusErrorGeneric', currentLanguage, {MESSAGE: (data.message || 'Could not download file.')})}</p>`;
                            }
                        }
                    } catch (error) {
                        console.error('Fetch error:', error);
                        statusArea.innerHTML = `<p class="text-red-400 p-3 bg-red-900/30 rounded-md status-message-item">${getTranslation('statusNetworkError')} (${error.message})</p>`;
                    } finally {
                        if(submitButtonEl) {
                            submitButtonEl.disabled = false;
                            submitButtonEl.classList.remove('opacity-50', 'cursor-not-allowed');
                            submitButtonEl.classList.add('hover:bg-sky-400');
                        }
                    }
                });
            } else {
                console.error("Download form not found!");
            }

            console.log("Initial setup complete. Downloader should be visible.");
        });
    </script>
</body>
</html>
